
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>X / NVO FAN TEAM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg: #000; --txt: #e7e9ea; --gray: #71767b; --blue: #1d9bf0; --border: #2f3336; --hr: #f91880; --rt: #00ba7c; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, sans-serif; }
        body { background: var(--bg); color: var(--txt); overflow-x: hidden; padding-bottom: 60px; }

        /* GİRİŞ EKRANI */
        #auth-screen { position: fixed; inset: 0; background: #000; z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .x-btn { width: 100%; max-width: 300px; padding: 14px; border-radius: 30px; border: none; font-weight: bold; margin-bottom: 12px; cursor: pointer; font-size: 1rem; }

        /* HEADER */
        header { position: sticky; top: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(12px); border-bottom: 1px solid var(--border); padding: 10px 15px; display: flex; align-items: center; z-index: 1000; }
        .nav-tabs { display: flex; flex: 1; justify-content: space-around; font-weight: bold; }
        .tab { padding-bottom: 10px; border-bottom: 4px solid transparent; cursor: pointer; color: var(--gray); }
        .tab.active { color: var(--txt); border-color: var(--blue); }

        /* TWEET TASARIMI (X.COM STİLİ) */
        .tweet { display: flex; padding: 12px 16px; border-bottom: 1px solid var(--border); position: relative; }
        .t-left { margin-right: 12px; }
        .t-left img { width: 40px; height: 40px; border-radius: 50%; }
        .t-right { flex: 1; }
        .t-header { display: flex; align-items: center; gap: 4px; margin-bottom: 2px; }
        .t-name { font-weight: bold; }
        .t-handle { color: var(--gray); font-size: 0.9rem; }
        .t-content { font-size: 0.95rem; line-height: 1.4; white-space: pre-wrap; margin-bottom: 10px; }
        
        /* ETKİLEŞİM DÜĞMELERİ */
        .t-actions { display: flex; justify-content: space-between; max-width: 350px; color: var(--gray); font-size: 0.85rem; }
        .act { display: flex; align-items: center; gap: 8px; cursor: pointer; transition: 0.2s; padding: 5px; border-radius: 20px; }
        .act:active { background: rgba(29,155,240,0.1); }
        .act.liked { color: var(--hr); }
        .act.retweeted { color: var(--rt); }
        
        /* ALT NAV BAR (GÖRSELDEKİ GİBİ) */
        nav { position: fixed; bottom: 0; width: 100%; background: #000; border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: 10px 0; z-index: 2000; }
        nav i { font-size: 1.4rem; color: #fff; cursor: pointer; width: 50px; text-align: center; }

        /* FAB (TWEET AT BUTONU) */
        .fab-tweet { position: fixed; bottom: 80px; right: 20px; width: 56px; height: 56px; background: var(--blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.5); z-index: 1500; }

        /* SAYFALAR */
        .page { display: none; } .page.active { display: block; }
        .verified { color: var(--blue); font-size: 0.8rem; }
    </style>
</head>
<body>

    <div id="auth-screen">
        <i class="fab fa-twitter" style="font-size: 3.5rem; color: #fff; margin-bottom: 50px;"></i>
        <button onclick="window.login('google')" class="x-btn" style="background: #fff; color: #000;">Google ile giriş yap</button>
        <button onclick="window.login('guest')" class="x-btn" style="background: transparent; border: 1px solid #555; color: #fff;">Giriş yapmadan göz at</button>
    </div>

    <header id="main-header" style="display:none;">
        <img src="" class="my-av" style="width:32px; height:32px; border-radius:50%; margin-right: 20px;" onclick="window.nav('profile')">
        <div class="nav-tabs">
            <div class="tab active">Sizin için</div>
            <div class="tab">Takip edilenler</div>
        </div>
        <i class="fas fa-cog" style="color:var(--gray); margin-left: 20px;"></i>
    </header>

    <div id="p-home" class="page active">
        <div id="feed"></div>
    </div>

    <div id="p-profile" class="page">
        <div style="height: 120px; background: #333;"></div>
        <div style="padding: 15px; margin-top: -45px;">
            <img src="" class="my-av" style="width: 80px; height: 80px; border-radius: 50%; border: 4px solid #000;">
            <h2 id="u-name" style="margin-top:10px;">İsim</h2>
            <p id="u-handle" style="color:var(--gray)">@kullanici</p>
        </div>
        <div id="my-posts"></div>
    </div>

    <div class="fab-tweet" onclick="window.openCompose()" id="tweet-fab" style="display:none;">
        <i class="fas fa-plus" style="color: #fff; font-size: 1.2rem;"></i>
    </div>

    <nav>
        <i class="fas fa-home" onclick="window.nav('home')"></i>
        <i class="fas fa-search"></i>
        <i class="far fa-bell"></i>
        <i class="far fa-envelope"></i>
        <i class="far fa-user" onclick="window.nav('profile')"></i>
    </nav>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
    import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp, doc, updateDoc, increment, getDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

    const cfg = { apiKey: "AIzaSyAh1FMjRRyQsiRUf1YKf0htPDSP-I8j-J8", authDomain: "nvo-fan.firebaseapp.com", projectId: "nvo-fan", storageBucket: "nvo-fan.appspot.com", messagingSenderId: "724570776040", appId: "1:724570776040:web:fdae1a49175a6bd44ac45d" };
    const app = initializeApp(cfg); const auth = getAuth(app); const db = getFirestore(app);

    let user = null;
    const ADMIN = "MEwls";

    // --- FONKSİYONLAR ---
    window.login = (m) => m === 'google' ? signInWithPopup(auth, new GoogleAuthProvider()) : signInAnonymously(auth);
    
    window.nav = (p) => {
        document.querySelectorAll('.page').forEach(x => x.classList.remove('active'));
        document.getElementById('p-' + p).classList.add('active');
        if(!user) window.showAuth();
    };

    window.openCompose = async () => {
        const text = prompt("Neler oluyor?");
        if(text && text.trim() && user) {
            await addDoc(collection(db, "posts"), {
                uid: user.uid, name: user.displayName || "Misafir",
                photo: user.photoURL || "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png",
                text: text, likes: 0, rts: 0, time: serverTimestamp()
            });
        }
    };

    window.interact = async (id, type) => {
        if(!user) return window.showAuth();
        const ref = doc(db, "posts", id);
        await updateDoc(ref, { [type]: increment(1) });
    };

    window.showAuth = () => document.getElementById('auth-screen').style.display = 'flex';

    // --- AUTH TAKİBİ ---
    onAuthStateChanged(auth, (u) => {
        if(u) {
            user = u;
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('main-header').style.display = 'flex';
            document.getElementById('tweet-fab').style.display = 'flex';
            
            const img = u.photoURL || "https://abs.twimg.com/sticky/default_profile_images/default_profile_normal.png";
            document.querySelectorAll('.my-av').forEach(el => el.src = img);
            document.getElementById('u-name').innerText = u.displayName || "Misafir";
            document.getElementById('u-handle').innerText = "@" + u.uid.slice(0,5);
            
            if(u.displayName && u.displayName.includes(ADMIN)) {
                document.getElementById('u-name').innerHTML += ' <i class="fas fa-check-circle verified"></i>';
            }
        }
        loadFeed();
    });

    function loadFeed() {
        onSnapshot(query(collection(db, "posts"), orderBy("time", "desc")), (snap) => {
            const feed = document.getElementById('feed');
            const myPosts = document.getElementById('my-posts');
            feed.innerHTML = ""; myPosts.innerHTML = "";

            snap.forEach(d => {
                const p = d.data();
                const isAdm = p.name.includes(ADMIN);
                const html = `
                    <div class="tweet">
                        <div class="t-left"><img src="${p.photo}"></div>
                        <div class="t-right">
                            <div class="t-header">
                                <span class="t-name">${p.name}</span>
                                ${isAdm ? '<i class="fas fa-check-circle verified"></i>' : ''}
                                <span class="t-handle">@${p.uid.slice(0,4)} · 1sa</span>
                            </div>
                            <div class="t-content">${p.text}</div>
                            <div class="t-actions">
                                <div class="act" onclick="window.interact('${d.id}', 'comments')"><i class="far fa-comment"></i> 0</div>
                                <div class="act" onclick="window.interact('${d.id}', 'rts')"><i class="fas fa-retweet"></i> ${p.rts || 0}</div>
                                <div class="act" onclick="window.interact('${d.id}', 'likes')"><i class="far fa-heart"></i> ${p.likes || 0}</div>
                                <div class="act"><i class="far fa-share-square"></i></div>
                            </div>
                        </div>
                    </div>`;
                feed.innerHTML += html;
                if(user && d.data().uid === user.uid) myPosts.innerHTML += html;
            });
        });
    }
</script>
</body>
</html>
