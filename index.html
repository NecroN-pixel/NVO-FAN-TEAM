<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NVO FAN TEAM | Elite Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #ff003c; --yt: #ff0000; --ig: #e1306c; --dark: #050505; --card: #111; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Rajdhani', sans-serif; }
        body { background: var(--dark); color: #fff; padding-bottom: 80px; overflow-x: hidden; }

        header { padding: 15px; background: #000; border-bottom: 2px solid var(--neon); position: sticky; top: 0; z-index: 1000; }
        .logo { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; color: var(--neon); text-align: center; letter-spacing: 3px; text-shadow: 0 0 10px var(--neon); }
        
        /* Sosyal Medya Butonları */
        .social-bar { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
        .social-link { padding: 10px 20px; border-radius: 30px; text-decoration: none; color: #fff; font-weight: bold; font-size: 0.8rem; display: flex; align-items: center; gap: 8px; transition: 0.3s; }
        .btn-yt { background: var(--yt); box-shadow: 0 0 15px rgba(255,0,0,0.3); }
        .btn-ig { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); box-shadow: 0 0 15px rgba(225,48,108,0.3); }
        .social-link:hover { transform: scale(1.05); }

        .news-ticker { background: #ff003c11; padding: 8px; border-bottom: 1px solid var(--neon); font-size: 0.8rem; overflow: hidden; white-space: nowrap; }
        .news-ticker div { display: inline-block; animation: scroll 20s linear infinite; }
        @keyframes scroll { from { transform: translateX(100%); } to { transform: translateX(-100%); } }

        .container { max-width: 500px; margin: auto; padding: 15px; }

        /* Gönderi ve Oda Kartları */
        .post-card { background: var(--card); border: 1px solid #222; padding: 15px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .post-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .post-avatar { width: 35px; height: 35px; border-radius: 50%; border: 1px solid var(--neon); object-fit: cover; }
        .post-user { color: var(--neon); font-weight: 800; font-size: 0.9rem; }

        /* Oda Seçici */
        .room-selector { display: flex; gap: 10px; overflow-x: auto; padding: 10px 0; margin-bottom: 15px; }
        .room-chip { background: #222; padding: 8px 18px; border-radius: 20px; border: 1px solid #444; white-space: nowrap; cursor: pointer; }
        .room-chip.active { background: var(--neon); color: #000; font-weight: 800; border-color: var(--neon); }

        /* Inputlar */
        input { width: 100%; padding: 12px; background: #000; border: 1px solid #333; color: #fff; border-radius: 8px; margin-top: 10px; outline: none; }
        input:focus { border-color: var(--neon); }
        .btn-post { width: 100%; padding: 15px; background: var(--neon); color: #000; border: none; border-radius: 8px; font-weight: 900; margin-top: 10px; cursor: pointer; }

        /* Navigasyon */
        .nav { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.95); display: flex; justify-content: space-around; padding: 18px; border-top: 1px solid var(--neon); backdrop-filter: blur(10px); }
        .nav i { font-size: 1.4rem; color: #555; cursor: pointer; }
        .nav i.active { color: var(--neon); text-shadow: 0 0 10px var(--neon); }

        .page { display: none; } .page.active { display: block; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <header><div class="logo">NVO FAN TEAM</div></header>
    
    <div id="ticker" class="news-ticker"><div>NVO FAN TEAM'e hoş geldiniz! Duyurular burada...</div></div>

    <div class="container">
        <div class="social-bar">
            <a href="https://www.youtube.com/@NVOOFFICAL" target="_blank" class="social-link btn-yt">
                <i class="fab fa-youtube"></i> YouTube
            </a>
            <a href="https://www.instagram.com/necron.offical" target="_blank" class="social-link btn-ig">
                <i class="fab fa-instagram"></i> Instagram
            </a>
        </div>

        <div id="adminPanel" style="display:none; background:#200; border:1px dashed var(--neon); padding:15px; margin-bottom:20px;">
            <input type="text" id="annIn" placeholder="Kayan duyuruyu değiştir...">
            <button onclick="postAnn()" class="btn-post">YAYINLA</button>
        </div>

        <div id="homePage" class="page active">
            <div id="postInput" class="post-card" style="display:none;">
                <input type="text" id="postText" placeholder="Neler oluyor?">
                <button onclick="sendPost()" class="btn-post">PAYLAŞ</button>
            </div>
            <div id="feedArea"></div>
        </div>

        <div id="roomsPage" class="page">
            <div class="room-selector">
                <div class="room-chip active" onclick="changeRoom('Genel', this)">Genel</div>
                <div class="room-chip" onclick="changeRoom('Oyun', this)">Oyun</div>
                <div class="room-chip" onclick="changeRoom('Takas', this)">Takas</div>
            </div>
            <div id="chatBox" style="height:400px; overflow-y:auto; background:#000; padding:15px; border-radius:10px; border:1px solid #222;"></div>
            <div id="chatControls" style="display:none;">
                <input type="text" id="msgIn" placeholder="Mesaj yaz...">
                <button onclick="sendMsg()" class="btn-post" style="padding:10px;">GÖNDER</button>
            </div>
        </div>

        <div id="profPage" class="page">
            <div class="post-card" style="text-align: center;">
                <img id="uImg" src="https://via.placeholder.com/100" style="width:100px;height:100px;border-radius:50%;border:2px solid var(--neon);object-fit:cover;">
                <h2 id="uName" style="margin:10px 0;">Yükleniyor...</h2>
                
                <input type="text" id="picUrl" placeholder="Hızlı Resim Kodu">
                <input type="text" id="nameIn" placeholder="Yeni Nickname">
                <button onclick="saveP()" class="btn-post">KAYDET</button>
                
                <div style="margin-top:20px; border-top:1px solid #333; padding-top:15px;">
                    <p style="font-size:0.8rem; color:#888; margin-bottom:10px;">Bizi Takip Et</p>
                    <div class="social-bar">
                        <a href="https://www.youtube.com/@NVOOFFICAL" target="_blank" class="social-link btn-yt"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.instagram.com/necron.offical" target="_blank" class="social-link btn-ig"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                
                <button onclick="out()" class="btn-post" style="background:#222; color:#fff; margin-top:20px;">ÇIKIŞ YAP</button>
            </div>
        </div>

        <div id="loginGate" style="text-align:center;"><button onclick="login()" class="btn-post" style="background:#fff; color:#000;">GOOGLE İLE GİRİŞ</button></div>
    </div>

    <nav class="nav">
        <i class="fas fa-home active" onclick="nav('home', this)"></i>
        <i class="fas fa-comments" onclick="nav('rooms', this)"></i>
        <i class="fas fa-user-circle" onclick="nav('prof', this)"></i>
    </nav>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc, onSnapshot, collection, addDoc, query, orderBy, serverTimestamp, where } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

    const cfg = {
        apiKey: "AIzaSyAh1FMjRRyQsiRUf1YKf0htPDSP-I8j-J8",
        authDomain: "nvo-fan.firebaseapp.com",
        projectId: "nvo-fan",
        storageBucket: "nvo-fan.appspot.com",
        messagingSenderId: "724570776040",
        appId: "1:724570776040:web:fdae1a49175a6bd44ac45d"
    };

    const app = initializeApp(cfg);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const prov = new GoogleAuthProvider();

    let currentRoom = "Genel";
    let currentUserData = null;

    function extractSrc(i) { const m = i.match(/src="([^"]+)"/); return m ? m[1] : i; }

    window.nav = (p, el) => {
        document.querySelectorAll('.page').forEach(x => x.classList.remove('active'));
        document.getElementById(p + 'Page').classList.add('active');
        document.querySelectorAll('.nav i').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
    };

    onAuthStateChanged(auth, async (u) => {
        if(u) {
            document.getElementById('loginGate').style.display = 'none';
            document.getElementById('postInput').style.display = 'block';
            document.getElementById('chatControls').style.display = 'block';
            const r = doc(db, "users", u.uid);
            const s = await getDoc(r);
            if(!s.exists()) {
                await setDoc(r, { name: u.displayName, photo: u.photoURL });
                currentUserData = { name: u.displayName, photo: u.photoURL };
            } else {
                currentUserData = s.data();
                document.getElementById('uImg').src = currentUserData.photo;
                document.getElementById('uName').innerText = currentUserData.name;
            }
            if(u.email === "necron.offical@gmail.com") document.getElementById('adminPanel').style.display = 'block';
        }
    });

    // Ana Akış
    onSnapshot(query(collection(db, "posts"), orderBy("time", "desc")), snap => {
        const area = document.getElementById('feedArea'); area.innerHTML = "";
        snap.forEach(d => {
            const p = d.data();
            area.innerHTML += `<div class="post-card">
                <div class="post-header"><img src="${p.photo}" class="post-avatar"><span class="post-user">${p.name}</span></div>
                <div class="post-content">${p.text}</div>
            </div>`;
        });
    });

    // Duyuru
    onSnapshot(doc(db, "stats", "ticker"), d => { if(d.exists()) document.getElementById('ticker').innerHTML = `<div>${d.data().text} • ${d.data().text}</div>`; });

    window.sendPost = async () => {
        const t = document.getElementById('postText').value;
        if(t.trim() && currentUserData){
            await addDoc(collection(db, "posts"), { name: currentUserData.name, photo: currentUserData.photo, text: t, time: serverTimestamp() });
            document.getElementById('postText').value = "";
        }
    };

    // Chat Odaları
    window.changeRoom = (name, el) => {
        currentRoom = name;
        document.querySelectorAll('.room-chip').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        loadMessages();
    };

    let unsubChat = null;
    function loadMessages() {
        if(unsubChat) unsubChat();
        const q = query(collection(db, "messages"), where("room", "==", currentRoom), orderBy("time", "asc"));
        unsubChat = onSnapshot(q, snap => {
            const box = document.getElementById('chatBox'); box.innerHTML = "";
            snap.forEach(d => {
                const m = d.data();
                box.innerHTML += `<div style="margin-bottom:12px; border-left:2px solid var(--neon); padding-left:10px;">
                    <small style="color:var(--neon); font-weight:bold;">${m.name}</small><br>${m.text}
                </div>`;
            });
            box.scrollTop = box.scrollHeight;
        });
    }
    loadMessages();

    window.sendMsg = async () => {
        const t = document.getElementById('msgIn').value;
        if(t.trim() && currentUserData){
            await addDoc(collection(db, "messages"), { name: currentUserData.name, photo: currentUserData.photo, text: t, room: currentRoom, time: serverTimestamp() });
            document.getElementById('msgIn').value = "";
        }
    };

    window.postAnn = async () => {
        const v = document.getElementById('annIn').value;
        if(v.trim()) await setDoc(doc(db, "stats", "ticker"), { text: v });
    };

    window.login = () => signInWithPopup(auth, prov);
    window.out = () => signOut(auth).then(() => location.reload());
    window.saveP = async () => {
        const n = document.getElementById('nameIn').value;
        const p = extractSrc(document.getElementById('picUrl').value);
        if(n.trim()){ await updateDoc(doc(db, "users", auth.currentUser.uid), { name: n, photo: p }); alert("Güncellendi!"); location.reload(); }
    };
</script>
</body>
</html>

